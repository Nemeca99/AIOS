version: '3.8'

services:
  # CARMA Mycelium Network - North America Region
  # Total Blocks: 19,047,619
  # Total Capacity: 1,142,857,140 users

  carma-block-na-001:
    image: carma-mycelium:latest
    container_name: carma-na-001
    environment:
      - BLOCK_ID=na_00000001
      - EXTERNAL_IP=203.0.113.1
      - INTERNAL_NETWORK=192.168.1.0/24
      - REGION=NA
      - MAX_USERS=60
    ports:
      - "443:443"
      - "80:80"
    networks:
      - carma-na-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  carma-na-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.na.0/16
          gateway: 172.20.na.1

volumes:
  carma-na-data:
    driver: local
