version: '3.8'

services:
  # CARMA Mycelium Network - Antarctica Region
  # Total Blocks: 19,047,620
  # Total Capacity: 1,142,857,200 users

  carma-block-an-001:
    image: carma-mycelium:latest
    container_name: carma-an-001
    environment:
      - BLOCK_ID=an_00000001
      - EXTERNAL_IP=203.0.113.1
      - INTERNAL_NETWORK=192.168.1.0/24
      - REGION=AN
      - MAX_USERS=60
    ports:
      - "443:443"
      - "80:80"
    networks:
      - carma-an-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  carma-an-network:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.an.0/16
          gateway: 172.20.an.1

volumes:
  carma-an-data:
    driver: local
